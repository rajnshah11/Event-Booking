{"ast":null,"code":"import React,{useState,useEffect,useCallback}from\"react\";import{useSelector}from\"react-redux\";// Use Redux hook\nimport Spinner from\"../Event/Spinner/Spinner\";import BookingList from\"./BookingList/BookingList\";import BookingsChart from\"./BookingsChart/BookingsChart\";import BookingsControl from\"./BookingsControl/BookingsControl\";import{fetchBookings,deleteBooking}from\"../../controller/bookingsContoller/bookingsController.js\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const BookingsPage=()=>{const[isLoading,setIsLoading]=useState(false);const[bookings,setBookings]=useState([]);const[outputType,setOutputType]=useState(\"list\");const[error,setError]=useState(null);const token=useSelector(state=>state.auth.token);const handleFetchBookings=useCallback(async()=>{setIsLoading(true);setError(null);try{const bookingsData=await fetchBookings(token);setBookings(bookingsData);}catch(err){console.error(err);setError(\"Failed to fetch bookings. Please try again later.\");}finally{setIsLoading(false);}},[token]);useEffect(()=>{handleFetchBookings();},[handleFetchBookings]);const handleDeleteBooking=async bookingId=>{setIsLoading(true);setError(null);try{await deleteBooking(token,bookingId);setBookings(prevBookings=>prevBookings.filter(booking=>booking._id!==bookingId));}catch(err){console.error(err);setError(\"Failed to cancel booking. Please try again later.\");}finally{setIsLoading(false);}};const changeOutputTypeHandler=type=>{setOutputType(type);};let content=/*#__PURE__*/_jsx(Spinner,{});if(!isLoading){content=/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(BookingsControl,{activeOutputType:outputType,onChange:changeOutputTypeHandler}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"div\",{children:outputType===\"list\"?/*#__PURE__*/_jsx(BookingList,{bookings:bookings,onDelete:handleDeleteBooking}):/*#__PURE__*/_jsx(BookingsChart,{bookings:bookings})})]});}return/*#__PURE__*/_jsx(_Fragment,{children:content});};export default BookingsPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useSelector","Spinner","BookingList","BookingsChart","BookingsControl","fetchBookings","deleteBooking","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","BookingsPage","isLoading","setIsLoading","bookings","setBookings","outputType","setOutputType","error","setError","token","state","auth","handleFetchBookings","bookingsData","err","console","handleDeleteBooking","bookingId","prevBookings","filter","booking","_id","changeOutputTypeHandler","type","content","children","activeOutputType","onChange","className","onDelete"],"sources":["/Users/rajshah/Desktop/Event-Booking/client/src/components/Bookings/Bookings.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { useSelector } from \"react-redux\"; // Use Redux hook\nimport Spinner from \"../Event/Spinner/Spinner\";\nimport BookingList from \"./BookingList/BookingList\";\nimport BookingsChart from \"./BookingsChart/BookingsChart\";\nimport BookingsControl from \"./BookingsControl/BookingsControl\";\nimport { fetchBookings, deleteBooking } from \"../../controller/bookingsContoller/bookingsController.js\";\n\nconst BookingsPage = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [bookings, setBookings] = useState([]);\n  const [outputType, setOutputType] = useState(\"list\");\n  const [error, setError] = useState(null);\n\n  const token = useSelector((state) => state.auth.token);\n\n  const handleFetchBookings = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const bookingsData = await fetchBookings(token);\n      setBookings(bookingsData);\n    } catch (err) {\n      console.error(err);\n      setError(\"Failed to fetch bookings. Please try again later.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [token]);\n\n  useEffect(() => {\n    handleFetchBookings();\n  }, [handleFetchBookings]);\n\n  const handleDeleteBooking = async (bookingId) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      await deleteBooking(token, bookingId);\n      setBookings((prevBookings) => prevBookings.filter((booking) => booking._id !== bookingId));\n    } catch (err) {\n      console.error(err);\n      setError(\"Failed to cancel booking. Please try again later.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const changeOutputTypeHandler = (type) => {\n    setOutputType(type);\n  };\n\n  let content = <Spinner />;\n  if (!isLoading) {\n    content = (\n      <>\n        <BookingsControl activeOutputType={outputType} onChange={changeOutputTypeHandler} />\n        {error && <p className=\"error-message\">{error}</p>}\n        <div>\n          {outputType === \"list\" ? (\n            <BookingList bookings={bookings} onDelete={handleDeleteBooking} />\n          ) : (\n            <BookingsChart bookings={bookings} />\n          )}\n        </div>\n      </>\n    );\n  }\n\n  return <>{content}</>;\n};\n\nexport default BookingsPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}