{"ast":null,"code":"var _jsxFileName = \"/Users/rajshah/Desktop/Event-Booking-master/client/src/components/Bookings/Bookings.js\";\nimport React, { Component } from \"react\";\nimport AuthContext from \"../../context/auth-context\";\nimport Spinner from \"../Event/Spinner/Spinner\";\nimport BookingList from \"./BookingList/BookingList\";\nimport BookingsChart from \"./BookingsChart/BookingsChart\";\nimport BookingsControl from \"./BookingsControl/BookingsControl\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass BookingsPage extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      isLoading: false,\n      bookings: [],\n      outputType: \"list\"\n    };\n    this.fetchBookings = () => {\n      this.setState({\n        isLoading: true\n      });\n      const requestBody = {\n        query: `query {\n        bookings {\n          _id\n          createdAt\n          event {\n            _id\n            title\n            date\n            price\n          }\n        }\n      }`\n      };\n      fetch(\"http://localhost:8000/graphql\", {\n        method: \"POST\",\n        body: JSON.stringify(requestBody),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + this.context.token\n        }\n      }).then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      }).then(resData => {\n        const bookings = resData.data.bookings;\n        this.setState({\n          bookings: bookings,\n          isLoading: false\n        });\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          isLoading: false\n        });\n      });\n    };\n    this.deleteBookingHandler = bookingId => {\n      this.setState({\n        isLoading: true\n      });\n      const requestBody = {\n        query: `mutation {\n        cancelBooking(bookingId: \"${bookingId}\") {\n          _id\n          title\n        }\n      }`\n      };\n      fetch(\"http://localhost:8000/graphql\", {\n        method: \"POST\",\n        body: JSON.stringify(requestBody),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + this.context.token\n        }\n      }).then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        return res.json();\n      }).then(_ => {\n        this.setState(prevState => {\n          const updatedBooking = prevState.bookings.filter(booking => {\n            return booking._id !== bookingId;\n          });\n          return {\n            bookings: updatedBooking,\n            isLoading: false\n          };\n        });\n      }).catch(err => {\n        console.log(err);\n        this.setState({\n          isLoading: false\n        });\n      });\n    };\n    this.ChangeOutputTypeHandler = outputType => {\n      outputType === \"list\" ? this.setState({\n        outputType: \"list\"\n      }) : this.setState({\n        outputType: \"chart\"\n      });\n    };\n  }\n  componentDidMount() {\n    this.fetchBookings();\n  }\n  render() {\n    let content = /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 19\n    }, this);\n    if (!this.state.isLoading) {\n      content = /*#__PURE__*/_jsxDEV(React.Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(BookingsControl, {\n          activeOutputType: this.state.outputType,\n          onChange: this.ChangeOutputTypeHandler\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: this.state.outputType === \"list\" ? /*#__PURE__*/_jsxDEV(BookingList, {\n            bookings: this.state.bookings,\n            onDelete: this.deleteBookingHandler\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(BookingsChart, {\n            bookings: this.state.bookings\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(React.Fragment, {\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 12\n    }, this);\n  }\n}\nBookingsPage.contextType = AuthContext;\nexport default BookingsPage;","map":{"version":3,"names":["React","Component","AuthContext","Spinner","BookingList","BookingsChart","BookingsControl","jsxDEV","_jsxDEV","BookingsPage","constructor","arguments","state","isLoading","bookings","outputType","fetchBookings","setState","requestBody","query","fetch","method","body","JSON","stringify","headers","Authorization","context","token","then","res","status","Error","json","resData","data","catch","err","console","log","deleteBookingHandler","bookingId","_","prevState","updatedBooking","filter","booking","_id","ChangeOutputTypeHandler","componentDidMount","render","content","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","children","activeOutputType","onChange","onDelete","contextType"],"sources":["/Users/rajshah/Desktop/Event-Booking-master/client/src/components/Bookings/Bookings.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport AuthContext from \"../../context/auth-context\";\nimport Spinner from \"../Event/Spinner/Spinner\";\nimport BookingList from \"./BookingList/BookingList\";\nimport BookingsChart from \"./BookingsChart/BookingsChart\";\nimport BookingsControl from \"./BookingsControl/BookingsControl\";\n\nclass BookingsPage extends Component {\n  state = {\n    isLoading: false,\n    bookings: [],\n    outputType: \"list\"\n  };\n\n  static contextType = AuthContext;\n\n  componentDidMount() {\n    this.fetchBookings();\n  }\n\n  fetchBookings = () => {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `query {\n        bookings {\n          _id\n          createdAt\n          event {\n            _id\n            title\n            date\n            price\n          }\n        }\n      }`\n    };\n\n    fetch(\"http://localhost:8000/graphql\", {\n      method: \"POST\",\n      body: JSON.stringify(requestBody),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + this.context.token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      })\n      .then(resData => {\n        const bookings = resData.data.bookings;\n        this.setState({ bookings: bookings, isLoading: false });\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({ isLoading: false });\n      });\n  };\n\n  deleteBookingHandler = bookingId => {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `mutation {\n        cancelBooking(bookingId: \"${bookingId}\") {\n          _id\n          title\n        }\n      }`\n    };\n\n    fetch(\"http://localhost:8000/graphql\", {\n      method: \"POST\",\n      body: JSON.stringify(requestBody),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + this.context.token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        return res.json();\n      })\n      .then(_ => {\n        this.setState(prevState => {\n          const updatedBooking = prevState.bookings.filter(booking => {\n            return booking._id !== bookingId;\n          });\n          return { bookings: updatedBooking, isLoading: false };\n        });\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({ isLoading: false });\n      });\n  };\n\n  ChangeOutputTypeHandler = outputType => {\n    outputType === \"list\"\n      ? this.setState({ outputType: \"list\" })\n      : this.setState({ outputType: \"chart\" });\n  };\n  render() {\n    let content = <Spinner />;\n    if (!this.state.isLoading) {\n      content = (\n        <React.Fragment>\n          <BookingsControl\n            activeOutputType={this.state.outputType}\n            onChange={this.ChangeOutputTypeHandler}\n          />\n          <div>\n            {this.state.outputType === \"list\" ? (\n              <BookingList\n                bookings={this.state.bookings}\n                onDelete={this.deleteBookingHandler}\n              />\n            ) : (\n              <BookingsChart bookings={this.state.bookings} />\n            )}\n          </div>\n        </React.Fragment>\n      );\n    }\n    return <React.Fragment>{content}</React.Fragment>;\n  }\n}\n\nexport default BookingsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}