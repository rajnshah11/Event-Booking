{"ast":null,"code":"import React,{useState,useEffect,useContext,useCallback}from\"react\";import AuthContext from\"../../context/auth-context\";import Spinner from\"../Event/Spinner/Spinner\";import BookingList from\"./BookingList/BookingList\";import BookingsChart from\"./BookingsChart/BookingsChart\";import BookingsControl from\"./BookingsControl/BookingsControl\";import{fetchBookings,deleteBooking}from\"../../controller/bookingsContoller/bookingsController.js\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BookingsPage=()=>{const[isLoading,setIsLoading]=useState(false);const[bookings,setBookings]=useState([]);const[outputType,setOutputType]=useState(\"list\");const[error,setError]=useState(null);const context=useContext(AuthContext);const handleFetchBookings=useCallback(async()=>{setIsLoading(true);setError(null);try{const bookingsData=await fetchBookings(context.token);setBookings(bookingsData);}catch(err){console.error(err);setError(\"Failed to fetch bookings. Please try again later.\");}finally{setIsLoading(false);}},[context.token]);useEffect(()=>{handleFetchBookings();},[handleFetchBookings]);const handleDeleteBooking=async bookingId=>{setIsLoading(true);setError(null);try{await deleteBooking(context.token,bookingId);setBookings(prevBookings=>prevBookings.filter(booking=>booking._id!==bookingId));}catch(err){console.error(err);setError(\"Failed to cancel booking. Please try again later.\");}finally{setIsLoading(false);}};const changeOutputTypeHandler=type=>{setOutputType(type);};let content=/*#__PURE__*/_jsx(Spinner,{});if(!isLoading){content=/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(BookingsControl,{activeOutputType:outputType,onChange:changeOutputTypeHandler}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsx(\"div\",{children:outputType===\"list\"?/*#__PURE__*/_jsx(BookingList,{bookings:bookings,onDelete:handleDeleteBooking}):/*#__PURE__*/_jsx(BookingsChart,{bookings:bookings})})]});}return/*#__PURE__*/_jsx(React.Fragment,{children:content});};export default BookingsPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","useCallback","AuthContext","Spinner","BookingList","BookingsChart","BookingsControl","fetchBookings","deleteBooking","jsx","_jsx","jsxs","_jsxs","BookingsPage","isLoading","setIsLoading","bookings","setBookings","outputType","setOutputType","error","setError","context","handleFetchBookings","bookingsData","token","err","console","handleDeleteBooking","bookingId","prevBookings","filter","booking","_id","changeOutputTypeHandler","type","content","Fragment","children","activeOutputType","onChange","className","onDelete"],"sources":["/Users/rajshah/Desktop/Event-Booking-master/client/src/components/Bookings/Bookings.js"],"sourcesContent":["import React, { useState, useEffect, useContext, useCallback } from \"react\";\nimport AuthContext from \"../../context/auth-context\";\nimport Spinner from \"../Event/Spinner/Spinner\";\nimport BookingList from \"./BookingList/BookingList\";\nimport BookingsChart from \"./BookingsChart/BookingsChart\";\nimport BookingsControl from \"./BookingsControl/BookingsControl\";\nimport { fetchBookings, deleteBooking } from \"../../controller/bookingsContoller/bookingsController.js\";\n\nconst BookingsPage = () => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [bookings, setBookings] = useState([]);\n  const [outputType, setOutputType] = useState(\"list\");\n  const [error, setError] = useState(null);\n\n  const context = useContext(AuthContext);\n\n  const handleFetchBookings = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const bookingsData = await fetchBookings(context.token);\n      setBookings(bookingsData);\n    } catch (err) {\n      console.error(err);\n      setError(\"Failed to fetch bookings. Please try again later.\");\n    } finally {\n      setIsLoading(false);\n    }\n  }, [context.token]);\n\n  useEffect(() => {\n    handleFetchBookings();\n  }, [handleFetchBookings]);\n\n  const handleDeleteBooking = async (bookingId) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      await deleteBooking(context.token, bookingId);\n      setBookings((prevBookings) => prevBookings.filter((booking) => booking._id !== bookingId));\n    } catch (err) {\n      console.error(err);\n      setError(\"Failed to cancel booking. Please try again later.\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const changeOutputTypeHandler = (type) => {\n    setOutputType(type);\n  };\n\n  let content = <Spinner />;\n  if (!isLoading) {\n    content = (\n      <React.Fragment>\n        <BookingsControl activeOutputType={outputType} onChange={changeOutputTypeHandler} />\n        {error && <p className=\"error-message\">{error}</p>}\n        <div>\n          {outputType === \"list\" ? (\n            <BookingList bookings={bookings} onDelete={handleDeleteBooking} />\n          ) : (\n            <BookingsChart bookings={bookings} />\n          )}\n        </div>\n      </React.Fragment>\n    );\n  }\n\n  return <React.Fragment>{content}</React.Fragment>;\n};\n\nexport default BookingsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}