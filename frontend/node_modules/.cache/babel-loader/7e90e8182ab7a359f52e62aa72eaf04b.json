{"ast":null,"code":"import _classCallCheck from \"/Users/rajshah/Desktop/Event-Booking-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/rajshah/Desktop/Event-Booking-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/rajshah/Desktop/Event-Booking-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/rajshah/Desktop/Event-Booking-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/rajshah/Desktop/Event-Booking-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/rajshah/Desktop/Event-Booking-master/client/src/pages/Bookings.js\";\nimport React, { Component } from \"react\";\nimport AuthContext from \"../context/auth-context\";\nimport Spinner from \"../components/Event/Spinner/Spinner\";\nimport BookingList from \"../components/Bookings/BookingList/BookingList\";\nimport BookingsChart from \"../components/Bookings/BookingsChart/BookingsChart\";\nimport BookingsControl from \"../components/Bookings/BookingsControl/BookingsControl\";\nvar BookingsPage = /*#__PURE__*/function (_Component) {\n  _inherits(BookingsPage, _Component);\n  function BookingsPage() {\n    var _getPrototypeOf2;\n    var _this;\n    _classCallCheck(this, BookingsPage);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(BookingsPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      isLoading: false,\n      bookings: [],\n      outputType: \"list\"\n    };\n    _this.fetchBookings = function () {\n      _this.setState({\n        isLoading: true\n      });\n      var requestBody = {\n        query: \"query {\\n        bookings {\\n          _id\\n          createdAt\\n          event {\\n            _id\\n            title\\n            date\\n            price\\n          }\\n        }\\n      }\"\n      };\n      fetch(\"http://localhost:8000/graphql\", {\n        method: \"POST\",\n        body: JSON.stringify(requestBody),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + _this.context.token\n        }\n      }).then(function (res) {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      }).then(function (resData) {\n        var bookings = resData.data.bookings;\n        _this.setState({\n          bookings: bookings,\n          isLoading: false\n        });\n      }).catch(function (err) {\n        console.log(err);\n        _this.setState({\n          isLoading: false\n        });\n      });\n    };\n    _this.deleteBookingHandler = function (bookingId) {\n      _this.setState({\n        isLoading: true\n      });\n      var requestBody = {\n        query: \"mutation {\\n        cancelBooking(bookingId: \\\"\".concat(bookingId, \"\\\") {\\n          _id\\n          title\\n        }\\n      }\")\n      };\n      fetch(\"http://localhost:8000/graphql\", {\n        method: \"POST\",\n        body: JSON.stringify(requestBody),\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + _this.context.token\n        }\n      }).then(function (res) {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      }).then(function (resData) {\n        _this.setState(function (prevState) {\n          var updatedBooking = prevState.bookings.filter(function (booking) {\n            return booking._id !== bookingId;\n          });\n          return {\n            bookings: updatedBooking,\n            isLoading: false\n          };\n        });\n      }).catch(function (err) {\n        console.log(err);\n        _this.setState({\n          isLoading: false\n        });\n      });\n    };\n    _this.ChangeOutputTypeHandler = function (outputType) {\n      outputType === \"list\" ? _this.setState({\n        outputType: \"list\"\n      }) : _this.setState({\n        outputType: \"chart\"\n      });\n    };\n    return _this;\n  }\n  _createClass(BookingsPage, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchBookings();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var content = /*#__PURE__*/React.createElement(Spinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 19\n        }\n      });\n      if (!this.state.isLoading) {\n        content = /*#__PURE__*/React.createElement(React.Fragment, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(BookingsControl, {\n          activeOutputType: this.state.outputType,\n          onChange: this.ChangeOutputTypeHandler,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 11\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 11\n          }\n        }, this.state.outputType === \"list\" ? /*#__PURE__*/React.createElement(BookingList, {\n          bookings: this.state.bookings,\n          onDelete: this.deleteBookingHandler,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 15\n          }\n        }) : /*#__PURE__*/React.createElement(BookingsChart, {\n          bookings: this.state.bookings,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 15\n          }\n        })));\n      }\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 12\n        }\n      }, content);\n    }\n  }]);\n  return BookingsPage;\n}(Component);\nBookingsPage.contextType = AuthContext;\nexport default BookingsPage;","map":{"version":3,"names":["React","Component","AuthContext","Spinner","BookingList","BookingsChart","BookingsControl","BookingsPage","_Component","_inherits","_getPrototypeOf2","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_possibleConstructorReturn","_getPrototypeOf","call","apply","concat","state","isLoading","bookings","outputType","fetchBookings","setState","requestBody","query","fetch","method","body","JSON","stringify","headers","Authorization","context","token","then","res","status","Error","json","resData","data","catch","err","console","log","deleteBookingHandler","bookingId","prevState","updatedBooking","filter","booking","_id","ChangeOutputTypeHandler","_createClass","key","value","componentDidMount","render","content","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","activeOutputType","onChange","onDelete","contextType"],"sources":["/Users/rajshah/Desktop/Event-Booking-master/client/src/pages/Bookings.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport AuthContext from \"../context/auth-context\";\nimport Spinner from \"../components/Event/Spinner/Spinner\";\nimport BookingList from \"../components/Bookings/BookingList/BookingList\";\nimport BookingsChart from \"../components/Bookings/BookingsChart/BookingsChart\";\nimport BookingsControl from \"../components/Bookings/BookingsControl/BookingsControl\";\n\nclass BookingsPage extends Component {\n  state = {\n    isLoading: false,\n    bookings: [],\n    outputType: \"list\"\n  };\n\n  static contextType = AuthContext;\n\n  componentDidMount() {\n    this.fetchBookings();\n  }\n\n  fetchBookings = () => {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `query {\n        bookings {\n          _id\n          createdAt\n          event {\n            _id\n            title\n            date\n            price\n          }\n        }\n      }`\n    };\n\n    fetch(\"http://localhost:8000/graphql\", {\n      method: \"POST\",\n      body: JSON.stringify(requestBody),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + this.context.token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      })\n      .then(resData => {\n        const bookings = resData.data.bookings;\n        this.setState({ bookings: bookings, isLoading: false });\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({ isLoading: false });\n      });\n  };\n\n  deleteBookingHandler = bookingId => {\n    this.setState({ isLoading: true });\n    const requestBody = {\n      query: `mutation {\n        cancelBooking(bookingId: \"${bookingId}\") {\n          _id\n          title\n        }\n      }`\n    };\n\n    fetch(\"http://localhost:8000/graphql\", {\n      method: \"POST\",\n      body: JSON.stringify(requestBody),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + this.context.token\n      }\n    })\n      .then(res => {\n        if (res.status !== 200 && res.status !== 201) {\n          throw new Error(\"Failed\");\n        }\n        //this will automatically extract and parse the res body\n        return res.json();\n      })\n      .then(resData => {\n        this.setState(prevState => {\n          const updatedBooking = prevState.bookings.filter(booking => {\n            return booking._id !== bookingId;\n          });\n          return { bookings: updatedBooking, isLoading: false };\n        });\n      })\n      .catch(err => {\n        console.log(err);\n        this.setState({ isLoading: false });\n      });\n  };\n\n  ChangeOutputTypeHandler = outputType => {\n    outputType === \"list\"\n      ? this.setState({ outputType: \"list\" })\n      : this.setState({ outputType: \"chart\" });\n  };\n  render() {\n    let content = <Spinner />;\n    if (!this.state.isLoading) {\n      content = (\n        <React.Fragment>\n          <BookingsControl\n            activeOutputType={this.state.outputType}\n            onChange={this.ChangeOutputTypeHandler}\n          />\n          <div>\n            {this.state.outputType === \"list\" ? (\n              <BookingList\n                bookings={this.state.bookings}\n                onDelete={this.deleteBookingHandler}\n              />\n            ) : (\n              <BookingsChart bookings={this.state.bookings} />\n            )}\n          </div>\n        </React.Fragment>\n      );\n    }\n    return <React.Fragment>{content}</React.Fragment>;\n  }\n}\n\nexport default BookingsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}